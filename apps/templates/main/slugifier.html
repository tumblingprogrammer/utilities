

{% extends "base.html" %}
{% load bootstrap3 %}
{% load fontawesome %}
{% load staticfiles %}

{% block title %} Slugifier
{% endblock %}

{% block head %}
{% endblock %}


{% block content %}


    <div class="container top-content-container">
        <h3>Slugifier</h3>


        <div class="slugify-container row">

            <div class="col-sm-6">
                <p>Text to be slugified<input type="text" class="form-control"
                                              name="text_to_slugify" id="text-to-slugify"></p>

                <p><span class="highlight">Optional</span> Prefix to the slugified text<input type="text"
                                                                                              class="form-control"
                                                                                              name="prefix_to_slugified_text"
                                                                                              id="prefix-to-slugified-text">
                </p>

                <p><span class="highlight">Optional</span> Suffix to the slugified text<input type="text"
                                                                                              class="form-control"
                                                                                              name="suffix_to_slugified_text"
                                                                                              id="suffix-to-slugified-text">
                </p>

                <p>Slugified text</p>
                <div class="slugify-results">
                    <span id="slugified-text" class="dimmed-text">the slugified text will show here</span>
                </div>
                <div class="button-bar-div">
                    <div class="button-div inline"><input id="copy-to-clipboard-btn" class="btn btn-primary"
                                                          type="button" value="copy to clipboard"
                                                          data-clipboard-target="#slugified-text"></div>
                    <div class="button-div inline"><input id="clear-slugifier-fields" class="btn btn-primary"
                                                          type="button" value="clear fields"></div>
                </div>
            </div>

            <div class="col-sm-6">
                <h4><span class="highlight">Optional</span> Markdown image link constructor</h4>
                <p>Prefix<input type="text" class="form-control"
                                name="prefix_to_the_link_constructor"
                                id="prefix-to-the-link-constructor"></p>

                <p>File location<input type="text" class="form-control" name="location_of_the_file"
                                       id="location-of-the-file"></p>

                <p>Constructed markdown link</p>
                <div class="slugify-results">
                <span id="markdown-link" class="dimmed-text"><!--
                    --><span class="markdown-link-fixed-text">![</span>
                    <span class="markdown-link-prefix-to-the-link-constructor">...prefix to the image link constructor...</span>
                    <span class="markdown-link-text-to-slugify">...text to be slugified...</span>
                    <span class="markdown-link-fixed-text">](</span>
                        <span id="markdown-link-location-of-the-file">... file location ...</span><!--
                    --><span id="markdown-link-slugified-file-name">... slugified file name ...</span>
                    <span class="markdown-link-fixed-text">"</span>
                    <span class="markdown-link-prefix-to-the-link-constructor">...prefix to the link constructor...</span>
                    <span class="markdown-link-text-to-slugify">...text to slugify...</span>
                    <span class="markdown-link-fixed-text">")</span>
                </span>
                </div>
                <div class="button-bar-div">
                    <div class="button-div inline"><input id="copy-to-clipboard-btn" class="btn btn-primary"
                                                          type="button" value="copy to clipboard"
                                                          data-clipboard-target="#markdown-link"></div>
                    <div class="button-div inline"><input id="clear-markdown-link-fields" class="btn btn-primary"
                                                          type="button" value="clear fields"></div>
                </div>

            </div>


        </div>

        <hr>

        <div class="button-div button inline"><input id="clear-all-fields" class="btn btn-primary" type="button"
                                                     value="clear all fields"></div>
        {#        <div class="button-div button inline"><input id="save-to-database" class="btn btn-primary" type="button"#}
        {#                                                     value="save to database"></div>#}


    </div>

{% endblock %}

{% block scripts %}

    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js"></script>

    <script type="text/javascript">

        new Clipboard('.btn'); // instantiation of clipboard.js

        var $text_to_slugify = $('#text-to-slugify');
        var $slugified_text = $('#slugified-text');
        var $prefix_to_slugified_text = $('#prefix-to-slugified-text');
        var $suffix_to_slugified_text = $('#suffix-to-slugified-text');
        var $markdown_link_prefix_to_the_link_constructor = $('.markdown-link-prefix-to-the-link-constructor');
        var $prefix_to_the_link_constructor = $('#prefix-to-the-link-constructor');
        var $markdown_link_text_to_slugify = $('.markdown-link-text-to-slugify');
        var $location_of_the_file = $('#location-of-the-file');
        var $markdown_link_location_of_the_file = $('#markdown-link-location-of-the-file');
        var $markdown_link_slugified_file_name = $('#markdown-link-slugified-file-name');
        var $markdown_link = $('#markdown-link');

        

        var text_to_slugify = $text_to_slugify.value;

        function slugify(text) {
            return text.toString().toLowerCase()
                .replace(/\s+/g, '-')           // Replace spaces with -
                .replace(/[^\w\-]+/g, '')       // Remove all non-word chars
                .replace(/\-\-+/g, '-')         // Replace multiple - with single -
                .replace(/^-+/, '')             // Trim - from start of text
                .replace(/-+$/, '');            // Trim - from end of text
        }

        function construct_strings() {
            $markdown_link.removeClass('dimmed-text');
            var slugified_text = $prefix_to_slugified_text.val() + slugify($text_to_slugify.val()) +
                $suffix_to_slugified_text.val();
            if (slugified_text === '') {
                $slugified_text.text('the slugified text will show here');
            }
            else {
                $slugified_text.removeClass('dimmed-text');
                $slugified_text.text(slugified_text);
            }


            $markdown_link_prefix_to_the_link_constructor.text($prefix_to_the_link_constructor.val());
            $markdown_link_text_to_slugify.text($text_to_slugify.val());

            $markdown_link_location_of_the_file.text($location_of_the_file.val());
            $markdown_link_slugified_file_name.text($slugified_text.text());
        }

        function clear_slugify_fields() {
            $prefix_to_slugified_text.val("");
            $suffix_to_slugified_text.val("");
            $text_to_slugify.val("");
            $slugified_text.addClass('dimmed-text');
            $slugified_text.text('the slugified text will show here');
        }

        function clear_markdown_image_link_constructor_fields() {
            $prefix_to_the_link_constructor.val("");
            $location_of_the_file.val("");
            $markdown_link.addClass('dimmed-text');
        }

        $(document).on('click', '#clear-slugifier-fields', function () {
            clear_slugify_fields();
        });

        $(document).on('click', '#clear-markdown-link-fields', function () {
            clear_markdown_image_link_constructor_fields();
        });

        $(document).on('click', '#clear-all-fields', function () {
            clear_slugify_fields();
            clear_markdown_image_link_constructor_fields();
        });

        $(document).on('input', $text_to_slugify, function () {
            construct_strings();
        });

        $(document).on('input', '#prefix-to-slugified-text', function () {
            construct_strings();
        });

        $(document).on('input', '#suffix-to-slugified-text', function () {
            construct_strings();
        });

        $(document).on('input', '#prefix-to-the-link-constructor', function () {
            construct_strings();
        });

        $(document).on('input', '#location-of-the-file', function () {
            construct_strings();
        });

    </script>

{% endblock %}